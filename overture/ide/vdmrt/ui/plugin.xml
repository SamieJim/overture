<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
<!-- Editor -->
   <extension
         point="org.eclipse.ui.editors">
      <editor
            class="org.overture.ide.vdmrt.ui.editor.core.VdmRtEditor"
            contributorClass="org.eclipse.ui.texteditor.BasicTextEditorActionContributor"
            default="true"
            icon="icons/cview16/vdmrt_file_tsk.gif"
            id="org.overture.ide.vdmrt.ui.VdmRtEditor"
            name="Vdm-Rt Editor">
         <contentTypeBinding
               contentTypeId="org.overture.ide.vdmrt.core.content-type">
         </contentTypeBinding>
      </editor>
   </extension>
   <!-- Wizards -->
   <extension
         point="org.eclipse.ui.newWizards">
      <wizard
            category="org.overture.ide.ui.wizard"
            class="org.overture.ide.vdmrt.ui.wizard.VdmRtNewProjectWizard"
            finalPerspective="org.overture.ide.ui.perspective"
            icon="icons/cview16/vdmrt_file_tsk.gif"
            id="org.overture.ide.vdmrt.ui.projectWizard"
            name="%newProjectWizardName"
            preferredPerspectives="org.overture.ide.ui.perspective"
            project="true">
      </wizard>
      <wizard
            category="org.overture.ide.ui.wizard"
            class="org.overture.ide.vdmrt.ui.wizard.VdmRtNewFileWizard"
            finalPerspective="org.overture.ide.ui.perspective"
            icon="icons/cview16/vdmrt_file_tsk.gif"
            id="org.overture.ide.vdmrt.ui.fileWizard"
            name="%newEmptyFile"
            preferredPerspectives="org.overture.ide.ui.perspective"
            project="false">
      </wizard>
      <wizard
            category="org.overture.ide.ui.wizard"
            class="org.overture.ide.vdmrt.ui.wizard.VdmRtNewClassWizard"
            finalPerspective="org.overture.ide.ui.perspective"
            icon="icons/obj16/class_obj.gif"
            id="org.overture.ide.vdmrt.ui.classWizard"
            name="%newClass"
            preferredPerspectives="org.overture.ide.ui.perspective"
            project="false">
      </wizard>
      <wizard
            category="org.overture.ide.ui.wizard"
            class="org.overture.ide.vdmrt.ui.wizard.VdmRtNewSystemWizard"
            finalPerspective="org.overture.ide.ui.perspective"
            icon="icons/obj16/system_obj.gif"
            id="org.overture.ide.vdmrt.ui.systemWizard"
            name="%newSystem"
            preferredPerspectives="org.overture.ide.ui.perspective"
            project="false">
      </wizard>
      <primaryWizard
            id="org.overture.ide.vdmrt.ui.projectWizard">
      </primaryWizard>
   </extension>
   
   <!-- Nature image -->
   <extension
         point="org.eclipse.ui.ide.projectNatureImages">
      <image
            icon="icons/ovr16/vdmrt_ovr.gif"
            id="org.overture.ide.vdmrt.ui.image1"
            natureId="org.overture.ide.vdmrt.core.nature">
      </image>
   </extension>

 <!-- VDM Explorer contribution of menus -->
   <extension
         point="org.eclipse.ui.navigator.navigatorContent">
      <commonWizard
            associatedExtensionId="org.overture.ide.ui.vdmNavigatorContent"
            menuGroupId="org.overture.ide.ui.vdm"
            type="new"
            wizardId="org.overture.ide.vdmrt.ui.projectWizard">
         <enablement></enablement>
      </commonWizard>
      <commonWizard
            menuGroupId="org.overture.ide.ui.vdm"
            type="new"
            wizardId="org.overture.ide.vdmrt.ui.fileWizard">
         <enablement>
            <or>
               <adapt
                     type="org.overture.ide.core.resources.IVdmProject">
                  <test
                        property="org.overture.ide.core.resources.dialect"
                        value="VDM_RT">
                  </test>
               </adapt>
               <adapt
                     type="org.eclipse.core.resources.IFolder">
                  <test
                        property="org.overture.ide.core.resources.dialect"
                        value="VDM_RT">
                  </test>
               </adapt>
            </or></enablement>
      </commonWizard>
      <commonWizard
            menuGroupId="org.overture.ide.ui.vdm"
            associatedExtensionId="org.overture.ide.ui.vdmNavigatorContent"
            type="new"
            wizardId="org.overture.ide.vdmrt.ui.classWizard">
         <enablement>
            <or>
               <adapt
                     type="org.overture.ide.core.resources.IVdmProject">
                  <test
                        property="org.overture.ide.core.resources.dialect"
                        value="VDM_RT">
                  </test>
               </adapt>
               <adapt
                     type="org.eclipse.core.resources.IFolder">
                  <test
                        property="org.overture.ide.core.resources.dialect"
                        value="VDM_RT">
                  </test>
               </adapt>
            </or></enablement>
      </commonWizard>
       <commonWizard
            menuGroupId="org.overture.ide.ui.vdm"
            associatedExtensionId="org.overture.ide.ui.vdmNavigatorContent"
            type="new"
            wizardId="org.overture.ide.vdmrt.ui.systemWizard">
         <enablement>
            <or>
               <adapt
                     type="org.overture.ide.core.resources.IVdmProject">
                  <test
                        property="org.overture.ide.core.resources.dialect"
                        value="VDM_RT">
                  </test>
               </adapt>
               <adapt
                     type="org.eclipse.core.resources.IFolder">
                  <test
                        property="org.overture.ide.core.resources.dialect"
                        value="VDM_RT">
                  </test>
               </adapt>
            </or></enablement>
      </commonWizard>
   </extension>
 
  <extension
        point="org.overture.ide.ui.templateContextType">
     <ContextId
           Id="org.overture.ide.vdmrt.ui.contextType">
     </ContextId>
  </extension>
  <extension
        point="org.eclipse.ui.editors.templates">
     <contextType
           class="org.overture.ide.vdmrt.ui.editor.contentAssist.VdmRtTemplateContextType"
           id="org.overture.ide.vdmrt.ui.contextType"
           name="VDM-RT Template context type">
     </contextType>
     <include
           file="templates/templates.xml">
     </include>
  </extension>
  <extension
        point="org.eclipse.ui.actionSetPartAssociations">
     <actionSetPartAssociation
           targetID="org.eclipse.debug.ui.launchActionSet">
        <part
              id="org.overture.ide.ui.VdmExplorer">
        </part>
     </actionSetPartAssociation>
  </extension>
  
  
  <!-- command conver vdmpp to vdmrt
  http://xpomul.bloggles.info/2008/08/12/advanced-features-in-eclipse-popup-menus-take-2-the-new-api/
  -->
  
  <!-- FIXME VDM RT clone still showing up on Compass side! -->
  <extension
        point="org.eclipse.ui.commands">
     <command
           id="org.overture.ide.vdmrt.ui.commandVdmPpToVdmRt"
           name="Clone as VDM-RT">
     </command>
  </extension>
  <extension
        point="org.eclipse.ui.handlers">
     <handler
           class="org.overture.ide.vdmrt.ui.handlers.ConvertVdmPpToVdmRtCommandHandler"
           commandId="org.overture.ide.vdmrt.ui.commandVdmPpToVdmRt">
     </handler>
  </extension>
  <extension point="org.eclipse.ui.menus">
  <menuContribution locationURI="popup:org.eclipse.ui.popup.any?after=additions">
     <command
           commandId="org.overture.ide.vdmrt.ui.commandVdmPpToVdmRt"
           style="push">
        <visibleWhen>
            <with variable="activeMenuSelection">
               <iterate
                     ifEmpty="false">
                  <adapt
                     type="org.overture.ide.core.resources.IVdmProject">
                  <test
                        property="org.overture.ide.core.resources.dialect"
                        value="VDM_PP">
                  </test>
               </adapt>
               </iterate>
           </with>
        </visibleWhen>
     </command>
  </menuContribution>
</extension>

</plugin>
